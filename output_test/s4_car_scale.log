Running eval with robust_para=0.2
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.2', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s4/best_checkpoint.pth
Test:  [  0/228]  eta: 0:06:07  mae: 69.0000 (69.0000)  time: 1.6113  data: 0.2013  max mem: 396
Test:  [ 10/228]  eta: 0:00:41  mae: 69.0000 (72.1818)  time: 0.1893  data: 0.0202  max mem: 396
Test:  [ 20/228]  eta: 0:00:24  mae: 56.0000 (63.1905)  time: 0.1200  data: 0.0116  max mem: 396
Test:  [ 30/228]  eta: 0:00:18  mae: 56.0000 (65.3548)  time: 0.0950  data: 0.0086  max mem: 396
Test:  [ 40/228]  eta: 0:00:15  mae: 54.0000 (63.7317)  time: 0.0826  data: 0.0070  max mem: 396
Test:  [ 50/228]  eta: 0:00:13  mae: 63.0000 (72.3725)  time: 0.0753  data: 0.0062  max mem: 396
Test:  [ 60/228]  eta: 0:00:12  mae: 63.0000 (69.2459)  time: 0.0722  data: 0.0056  max mem: 396
Test:  [ 70/228]  eta: 0:00:10  mae: 61.0000 (66.9859)  time: 0.0695  data: 0.0053  max mem: 396
Test:  [ 80/228]  eta: 0:00:09  mae: 55.0000 (62.3704)  time: 0.0669  data: 0.0049  max mem: 396
Test:  [ 90/228]  eta: 0:00:08  mae: 48.0000 (56.8242)  time: 0.0646  data: 0.0047  max mem: 396
Test:  [100/228]  eta: 0:00:08  mae: 37.0000 (53.0297)  time: 0.0632  data: 0.0045  max mem: 396
Test:  [110/228]  eta: 0:00:07  mae: 34.0000 (50.7297)  time: 0.0619  data: 0.0043  max mem: 396
Test:  [120/228]  eta: 0:00:06  mae: 31.0000 (48.5289)  time: 0.0608  data: 0.0042  max mem: 396
Test:  [130/228]  eta: 0:00:05  mae: 28.0000 (46.3817)  time: 0.0598  data: 0.0041  max mem: 396
Test:  [140/228]  eta: 0:00:05  mae: 29.0000 (44.9858)  time: 0.0587  data: 0.0040  max mem: 396
Test:  [150/228]  eta: 0:00:04  mae: 28.0000 (44.2781)  time: 0.0580  data: 0.0039  max mem: 396
Test:  [160/228]  eta: 0:00:03  mae: 28.0000 (44.1118)  time: 0.0577  data: 0.0038  max mem: 396
Test:  [170/228]  eta: 0:00:03  mae: 27.0000 (44.1637)  time: 0.0584  data: 0.0037  max mem: 468
Test:  [180/228]  eta: 0:00:02  mae: 27.0000 (48.5912)  time: 0.0581  data: 0.0036  max mem: 468
Test:  [190/228]  eta: 0:00:02  mae: 24.0000 (46.2408)  time: 0.0576  data: 0.0036  max mem: 468
Test:  [200/228]  eta: 0:00:01  mae: 24.0000 (44.0398)  time: 0.0571  data: 0.0035  max mem: 468
Test:  [210/228]  eta: 0:00:01  mae: 23.0000 (42.1327)  time: 0.0572  data: 0.0035  max mem: 468
Test:  [220/228]  eta: 0:00:00  mae: 19.0000 (40.4299)  time: 0.0571  data: 0.0034  max mem: 468
Test:  [227/228]  eta: 0:00:00  mae: 13.0000 (39.2675)  time: 0.0569  data: 0.0034  max mem: 468
Test: Total time: 0:00:13 (0.0574 s / it)
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.2', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001) 

infer from: base_s4
inferring time: 13.1034s
FPS: 17.40
params: 50.065604
epoch: 1445			gt > 100 ended with 'ac' below:
mae 	 39.26754385964912	mae_ac 	 166.0
mse 	 66.14481056675784	mse_ac 	 191.0732843701599
Prec 	 0.5237845167475373	pre_ac 	 0.35791966104137196
Recall 	 0.2416754842697645	rec_ac 	 0.03459029205616431
F1_s 	 0.29355006228775143	f1_ac 	 0.05946090117539445
abs 	 0.7220867431454536	abs_ac 	 0.9516302361183058
r2 	 -1.3587599123446954	r2_ac 	 -3.1473231794402556
racc 	 0.21271837875611466	rac_ac 	 0.04515386827725054
rmae 	 70.00152534365257	rmse 	 77.26809306114542
Finished eval with robust_para=0.2
----------------------------------------
Running eval with robust_para=0.4
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.4', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s4/best_checkpoint.pth
Test:  [  0/228]  eta: 0:06:07  mae: 1.0000 (1.0000)  time: 1.6116  data: 0.1900  max mem: 733
Test:  [ 10/228]  eta: 0:00:50  mae: 12.0000 (10.5455)  time: 0.2321  data: 0.0194  max mem: 733
Test:  [ 20/228]  eta: 0:00:33  mae: 6.0000 (10.7619)  time: 0.1591  data: 0.0113  max mem: 733
Test:  [ 30/228]  eta: 0:00:27  mae: 12.0000 (15.2258)  time: 0.1371  data: 0.0084  max mem: 733
Test:  [ 40/228]  eta: 0:00:23  mae: 12.0000 (16.8293)  time: 0.1249  data: 0.0070  max mem: 733
Test:  [ 50/228]  eta: 0:00:21  mae: 17.0000 (22.5882)  time: 0.1219  data: 0.0061  max mem: 733
Test:  [ 60/228]  eta: 0:00:19  mae: 18.0000 (22.6066)  time: 0.1152  data: 0.0055  max mem: 733
Test:  [ 70/228]  eta: 0:00:17  mae: 18.0000 (21.7465)  time: 0.1118  data: 0.0052  max mem: 733
Test:  [ 80/228]  eta: 0:00:16  mae: 16.0000 (19.3210)  time: 0.1085  data: 0.0048  max mem: 733
Test:  [ 90/228]  eta: 0:00:14  mae: 11.0000 (17.3407)  time: 0.1042  data: 0.0046  max mem: 733
Test:  [100/228]  eta: 0:00:12  mae: 8.0000 (15.8218)  time: 0.1011  data: 0.0044  max mem: 733
Test:  [110/228]  eta: 0:00:11  mae: 6.0000 (14.6306)  time: 0.0990  data: 0.0042  max mem: 733
Test:  [120/228]  eta: 0:00:10  mae: 5.0000 (13.6364)  time: 0.0973  data: 0.0041  max mem: 733
Test:  [130/228]  eta: 0:00:09  mae: 5.0000 (12.9618)  time: 0.0954  data: 0.0040  max mem: 733
Test:  [140/228]  eta: 0:00:08  mae: 4.0000 (12.2553)  time: 0.0938  data: 0.0039  max mem: 733
Test:  [150/228]  eta: 0:00:07  mae: 3.0000 (11.6755)  time: 0.0928  data: 0.0038  max mem: 733
Test:  [160/228]  eta: 0:00:06  mae: 3.0000 (11.2671)  time: 0.0929  data: 0.0037  max mem: 733
Test:  [170/228]  eta: 0:00:05  mae: 3.0000 (11.7427)  time: 0.0941  data: 0.0037  max mem: 1000
Test:  [180/228]  eta: 0:00:04  mae: 2.0000 (13.4033)  time: 0.0970  data: 0.0036  max mem: 1266
Test:  [190/228]  eta: 0:00:03  mae: 2.0000 (12.7330)  time: 0.0952  data: 0.0036  max mem: 1266
Test:  [200/228]  eta: 0:00:02  mae: 2.0000 (12.1343)  time: 0.0936  data: 0.0035  max mem: 1266
Test:  [210/228]  eta: 0:00:01  mae: 2.0000 (11.6445)  time: 0.0925  data: 0.0035  max mem: 1266
Test:  [220/228]  eta: 0:00:00  mae: 2.0000 (11.1810)  time: 0.0918  data: 0.0034  max mem: 1266
Test:  [227/228]  eta: 0:00:00  mae: 2.0000 (10.8816)  time: 0.0913  data: 0.0034  max mem: 1266
Test: Total time: 0:00:20 (0.0917 s / it)
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.4', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001) 

infer from: base_s4
inferring time: 20.9157s
FPS: 10.90
params: 50.065604
epoch: 1445			gt > 100 ended with 'ac' below:
mae 	 10.881578947368421	mae_ac 	 57.7
mse 	 22.93574166261111	mse_ac 	 69.01449123191448
Prec 	 0.8845471993373385	pre_ac 	 0.8392192765387856
Recall 	 0.7895570367632473	rec_ac 	 0.5584175125853845
F1_s 	 0.8233000077501721	f1_ac 	 0.6606665925933576
abs 	 0.16962780044622378	abs_ac 	 0.33555794337363326
r2 	 0.7822643794982823	r2_ac 	 0.45893614441168107
racc 	 0.8145352900069881	rac_ac 	 0.6681046879493817
rmae 	 15.367297901089588	rmse 	 22.237488573961382
Finished eval with robust_para=0.4
----------------------------------------
Running eval with robust_para=0.6
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.6', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s4/best_checkpoint.pth
Test:  [  0/228]  eta: 0:06:31  mae: 9.0000 (9.0000)  time: 1.7172  data: 0.2113  max mem: 1399
Test:  [ 10/228]  eta: 0:01:06  mae: 4.0000 (4.1818)  time: 0.3053  data: 0.0219  max mem: 1399
Test:  [ 20/228]  eta: 0:00:45  mae: 2.0000 (3.2381)  time: 0.2167  data: 0.0127  max mem: 1399
Test:  [ 30/228]  eta: 0:00:39  mae: 3.0000 (3.6774)  time: 0.1990  data: 0.0096  max mem: 1399
Test:  [ 40/228]  eta: 0:00:34  mae: 3.0000 (3.7805)  time: 0.1811  data: 0.0079  max mem: 1399
Test:  [ 50/228]  eta: 0:00:32  mae: 3.0000 (4.0196)  time: 0.1847  data: 0.0069  max mem: 1399
Test:  [ 60/228]  eta: 0:00:29  mae: 3.0000 (3.7377)  time: 0.1739  data: 0.0063  max mem: 1399
Test:  [ 70/228]  eta: 0:00:26  mae: 2.0000 (3.4085)  time: 0.1687  data: 0.0059  max mem: 1399
Test:  [ 80/228]  eta: 0:00:23  mae: 2.0000 (3.1852)  time: 0.1604  data: 0.0055  max mem: 1399
Test:  [ 90/228]  eta: 0:00:20  mae: 2.0000 (2.9780)  time: 0.1517  data: 0.0052  max mem: 1399
Test:  [100/228]  eta: 0:00:18  mae: 2.0000 (2.7723)  time: 0.1455  data: 0.0049  max mem: 1399
Test:  [110/228]  eta: 0:00:16  mae: 2.0000 (2.6757)  time: 0.1411  data: 0.0048  max mem: 1399
Test:  [120/228]  eta: 0:00:14  mae: 1.0000 (2.5702)  time: 0.1373  data: 0.0046  max mem: 1399
Test:  [130/228]  eta: 0:00:13  mae: 1.0000 (2.5115)  time: 0.1337  data: 0.0044  max mem: 1399
Test:  [140/228]  eta: 0:00:11  mae: 1.0000 (2.3972)  time: 0.1307  data: 0.0043  max mem: 1399
Test:  [150/228]  eta: 0:00:10  mae: 1.0000 (2.3642)  time: 0.1285  data: 0.0042  max mem: 1399
Test:  [160/228]  eta: 0:00:08  mae: 1.0000 (2.3851)  time: 0.1279  data: 0.0041  max mem: 1399
Test:  [170/228]  eta: 0:00:07  mae: 1.0000 (2.7895)  time: 0.1315  data: 0.0041  max mem: 1799
Test:  [180/228]  eta: 0:00:06  mae: 1.0000 (4.0939)  time: 0.1380  data: 0.0040  max mem: 2199
Test:  [190/228]  eta: 0:00:05  mae: 1.0000 (3.8953)  time: 0.1353  data: 0.0039  max mem: 2199
Test:  [200/228]  eta: 0:00:03  mae: 1.0000 (3.7214)  time: 0.1324  data: 0.0039  max mem: 2199
Test:  [210/228]  eta: 0:00:02  mae: 1.0000 (3.5782)  time: 0.1302  data: 0.0038  max mem: 2199
Test:  [220/228]  eta: 0:00:01  mae: 1.0000 (3.4977)  time: 0.1295  data: 0.0038  max mem: 2199
Test:  [227/228]  eta: 0:00:00  mae: 1.0000 (3.4474)  time: 0.1293  data: 0.0038  max mem: 2199
Test: Total time: 0:00:29 (0.1299 s / it)
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.6', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001) 

infer from: base_s4
inferring time: 29.6179s
FPS: 7.70
params: 50.065604
epoch: 1445			gt > 100 ended with 'ac' below:
mae 	 3.4473684210526314	mae_ac 	 17.35
mse 	 10.491015370724224	mse_ac 	 32.89908813325986
Prec 	 0.9104728238058601	pre_ac 	 0.8793650741288627
Recall 	 0.9217074193359194	rec_ac 	 0.8245908142882664
F1_s 	 0.913542993931994	f1_ac 	 0.8480459645436091
abs 	 0.07355404797977182	abs_ac 	 0.08339445026434573
r2 	 0.9695881241594303	r2_ac 	 0.8770479815040905
racc 	 0.9386443046820405	rac_ac 	 0.9002013229795801
rmae 	 7.260785545240897	rmse 	 14.867404789311209
Finished eval with robust_para=0.6
----------------------------------------
Running eval with robust_para=0.8
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.8', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s4/best_checkpoint.pth
Test:  [  0/228]  eta: 0:06:58  mae: 7.0000 (7.0000)  time: 1.8334  data: 0.2295  max mem: 1798
Test:  [ 10/228]  eta: 0:01:13  mae: 2.0000 (3.2727)  time: 0.3388  data: 0.0238  max mem: 2330
Test:  [ 20/228]  eta: 0:00:49  mae: 2.0000 (2.5714)  time: 0.2393  data: 0.0138  max mem: 2330
Test:  [ 30/228]  eta: 0:00:44  mae: 2.0000 (2.5484)  time: 0.2230  data: 0.0104  max mem: 2330
Test:  [ 40/228]  eta: 0:00:37  mae: 2.0000 (2.7805)  time: 0.2011  data: 0.0086  max mem: 2330
Test:  [ 50/228]  eta: 0:00:37  mae: 2.0000 (2.8824)  time: 0.2106  data: 0.0076  max mem: 2330
Test:  [ 60/228]  eta: 0:00:33  mae: 2.0000 (2.7705)  time: 0.1969  data: 0.0068  max mem: 2330
Test:  [ 70/228]  eta: 0:00:30  mae: 2.0000 (2.6197)  time: 0.1938  data: 0.0064  max mem: 2330
Test:  [ 80/228]  eta: 0:00:27  mae: 2.0000 (2.4321)  time: 0.1859  data: 0.0060  max mem: 2330
Test:  [ 90/228]  eta: 0:00:24  mae: 2.0000 (2.2418)  time: 0.1768  data: 0.0057  max mem: 2330
Test:  [100/228]  eta: 0:00:21  mae: 1.0000 (2.0792)  time: 0.1701  data: 0.0055  max mem: 2330
Test:  [110/228]  eta: 0:00:19  mae: 1.0000 (2.0360)  time: 0.1663  data: 0.0053  max mem: 2330
Test:  [120/228]  eta: 0:00:17  mae: 1.0000 (2.0000)  time: 0.1636  data: 0.0052  max mem: 2330
Test:  [130/228]  eta: 0:00:15  mae: 1.0000 (2.0153)  time: 0.1598  data: 0.0051  max mem: 2330
Test:  [140/228]  eta: 0:00:13  mae: 1.0000 (1.9362)  time: 0.1566  data: 0.0050  max mem: 2330
Test:  [150/228]  eta: 0:00:12  mae: 1.0000 (1.9404)  time: 0.1556  data: 0.0049  max mem: 2330
Test:  [160/228]  eta: 0:00:10  mae: 1.0000 (1.9689)  time: 0.1572  data: 0.0048  max mem: 2330
Test:  [170/228]  eta: 0:00:09  mae: 1.0000 (2.3801)  time: 0.1625  data: 0.0048  max mem: 2864
Test:  [180/228]  eta: 0:00:08  mae: 1.0000 (3.6464)  time: 0.1739  data: 0.0048  max mem: 2997
Test:  [190/228]  eta: 0:00:06  mae: 1.0000 (3.4660)  time: 0.1711  data: 0.0047  max mem: 2997
Test:  [200/228]  eta: 0:00:04  mae: 1.0000 (3.3184)  time: 0.1683  data: 0.0047  max mem: 2997
Test:  [210/228]  eta: 0:00:03  mae: 1.0000 (3.1991)  time: 0.1667  data: 0.0046  max mem: 2997
Test:  [220/228]  eta: 0:00:01  mae: 1.0000 (3.1041)  time: 0.1657  data: 0.0046  max mem: 2997
Test:  [227/228]  eta: 0:00:00  mae: 1.0000 (3.0439)  time: 0.1648  data: 0.0046  max mem: 2997
Test: Total time: 0:00:37 (0.1652 s / it)
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.8', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001) 

infer from: base_s4
inferring time: 37.6766s
FPS: 6.05
params: 50.065604
epoch: 1445			gt > 100 ended with 'ac' below:
mae 	 3.043859649122807	mae_ac 	 14.95
mse 	 9.453951183629844	mse_ac 	 28.829672214577812
Prec 	 0.9246177736703002	pre_ac 	 0.9081422980073531
Recall 	 0.9469061953716246	rec_ac 	 0.9011869803192536
F1_s 	 0.933834695968505	f1_ac 	 0.9018753370145982
abs 	 0.06360621598123838	abs_ac 	 0.06509551560721424
r2 	 0.9668707299735018	r2_ac 	 0.9055836188175034
racc 	 0.9447938504542278	rac_ac 	 0.914006327293644
rmae 	 6.346301409412537	rmse 	 12.794648804136276
Finished eval with robust_para=0.8
----------------------------------------
Running eval with robust_para=1.0
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.0', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s4/best_checkpoint.pth
Test:  [  0/228]  eta: 0:07:12  mae: 7.0000 (7.0000)  time: 1.8987  data: 0.2421  max mem: 2865
Test:  [ 10/228]  eta: 0:01:26  mae: 3.0000 (3.0909)  time: 0.3952  data: 0.0251  max mem: 3529
Test:  [ 20/228]  eta: 0:00:57  mae: 1.0000 (2.7619)  time: 0.2776  data: 0.0147  max mem: 3529
Test:  [ 30/228]  eta: 0:00:55  mae: 2.0000 (2.5484)  time: 0.2808  data: 0.0114  max mem: 3529
Test:  [ 40/228]  eta: 0:00:48  mae: 2.0000 (2.4390)  time: 0.2602  data: 0.0095  max mem: 3529
Test:  [ 50/228]  eta: 0:00:48  mae: 2.0000 (2.7059)  time: 0.2735  data: 0.0084  max mem: 3529
Test:  [ 60/228]  eta: 0:00:43  mae: 2.0000 (2.7705)  time: 0.2595  data: 0.0076  max mem: 3529
Test:  [ 70/228]  eta: 0:00:40  mae: 2.0000 (2.5775)  time: 0.2542  data: 0.0071  max mem: 3529
Test:  [ 80/228]  eta: 0:00:35  mae: 2.0000 (2.3827)  time: 0.2420  data: 0.0067  max mem: 3529
Test:  [ 90/228]  eta: 0:00:31  mae: 1.0000 (2.1648)  time: 0.2287  data: 0.0063  max mem: 3529
Test:  [100/228]  eta: 0:00:28  mae: 1.0000 (2.0297)  time: 0.2190  data: 0.0060  max mem: 3529
Test:  [110/228]  eta: 0:00:25  mae: 1.0000 (1.9459)  time: 0.2122  data: 0.0058  max mem: 3529
Test:  [120/228]  eta: 0:00:22  mae: 1.0000 (1.8926)  time: 0.2066  data: 0.0057  max mem: 3529
Test:  [130/228]  eta: 0:00:19  mae: 1.0000 (1.8855)  time: 0.2012  data: 0.0055  max mem: 3529
Test:  [140/228]  eta: 0:00:17  mae: 1.0000 (1.8085)  time: 0.1968  data: 0.0054  max mem: 3529
Test:  [150/228]  eta: 0:00:15  mae: 1.0000 (1.7815)  time: 0.1937  data: 0.0053  max mem: 3529
Test:  [160/228]  eta: 0:00:13  mae: 1.0000 (1.8199)  time: 0.1936  data: 0.0052  max mem: 3529
Test:  [170/228]  eta: 0:00:11  mae: 1.0000 (2.0994)  time: 0.2015  data: 0.0052  max mem: 4195
Test:  [180/228]  eta: 0:00:10  mae: 1.0000 (2.5359)  time: 0.2187  data: 0.0051  max mem: 4460
Test:  [190/228]  eta: 0:00:08  mae: 1.0000 (2.4188)  time: 0.2143  data: 0.0051  max mem: 4460
Test:  [200/228]  eta: 0:00:05  mae: 1.0000 (2.3035)  time: 0.2101  data: 0.0050  max mem: 4460
Test:  [210/228]  eta: 0:00:03  mae: 1.0000 (2.2275)  time: 0.2072  data: 0.0050  max mem: 4460
Test:  [220/228]  eta: 0:00:01  mae: 1.0000 (2.1674)  time: 0.2076  data: 0.0050  max mem: 4460
Test:  [227/228]  eta: 0:00:00  mae: 1.0000 (2.1316)  time: 0.2084  data: 0.0050  max mem: 4460
Test: Total time: 0:00:47 (0.2089 s / it)
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.0', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001) 

infer from: base_s4
inferring time: 47.6472s
FPS: 4.79
params: 50.065604
epoch: 1445			gt > 100 ended with 'ac' below:
mae 	 2.1315789473684212	mae_ac 	 5.45
mse 	 4.382981441415133	mse_ac 	 7.179832867135557
Prec 	 0.9343798307709174	pre_ac 	 0.9227282746620608
Recall 	 0.9508703491383648	rec_ac 	 0.9384948807291977
F1_s 	 0.9399168425830581	f1_ac 	 0.9303556571866605
abs 	 0.052753770332881006	abs_ac 	 0.028879244501674856
r2 	 0.9704527495822257	r2_ac 	 0.9941440600975062
racc 	 0.9473095737246681	rac_ac 	 0.9686511360368133
rmae 	 5.504939781665086	rmse 	 11.334392702054789
Finished eval with robust_para=1.0
----------------------------------------
Running eval with robust_para=1.2
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.2', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s4/best_checkpoint.pth
Test:  [  0/228]  eta: 0:07:56  mae: 7.0000 (7.0000)  time: 2.0902  data: 0.2907  max mem: 4195
Test:  [ 10/228]  eta: 0:01:46  mae: 2.0000 (3.5455)  time: 0.4902  data: 0.0302  max mem: 4993
Test:  [ 20/228]  eta: 0:01:15  mae: 1.0000 (2.6667)  time: 0.3607  data: 0.0175  max mem: 4993
Test:  [ 30/228]  eta: 0:01:11  mae: 1.0000 (2.4194)  time: 0.3630  data: 0.0133  max mem: 4993
Test:  [ 40/228]  eta: 0:01:01  mae: 1.0000 (2.3659)  time: 0.3281  data: 0.0110  max mem: 4993
Test:  [ 50/228]  eta: 0:01:01  mae: 1.0000 (2.4510)  time: 0.3454  data: 0.0098  max mem: 4993
Test:  [ 60/228]  eta: 0:00:54  mae: 1.0000 (2.3115)  time: 0.3257  data: 0.0088  max mem: 4993
Test:  [ 70/228]  eta: 0:00:50  mae: 1.0000 (2.1831)  time: 0.3204  data: 0.0082  max mem: 4993
Test:  [ 80/228]  eta: 0:00:45  mae: 1.0000 (2.0988)  time: 0.3052  data: 0.0077  max mem: 4993
Test:  [ 90/228]  eta: 0:00:39  mae: 1.0000 (1.9231)  time: 0.2886  data: 0.0073  max mem: 4993
Test:  [100/228]  eta: 0:00:35  mae: 1.0000 (1.8317)  time: 0.2765  data: 0.0070  max mem: 4993
Test:  [110/228]  eta: 0:00:31  mae: 1.0000 (1.7477)  time: 0.2679  data: 0.0067  max mem: 4993
Test:  [120/228]  eta: 0:00:28  mae: 1.0000 (1.7273)  time: 0.2608  data: 0.0065  max mem: 4993
Test:  [130/228]  eta: 0:00:24  mae: 1.0000 (1.7634)  time: 0.2539  data: 0.0063  max mem: 4993
Test:  [140/228]  eta: 0:00:21  mae: 1.0000 (1.6879)  time: 0.2484  data: 0.0062  max mem: 4993
Test:  [150/228]  eta: 0:00:19  mae: 1.0000 (1.6887)  time: 0.2452  data: 0.0061  max mem: 4993
Test:  [160/228]  eta: 0:00:16  mae: 1.0000 (1.7267)  time: 0.2459  data: 0.0059  max mem: 4993
Test:  [170/228]  eta: 0:00:14  mae: 1.0000 (2.2105)  time: 0.2559  data: 0.0059  max mem: 4993
Test:  [180/228]  eta: 0:00:13  mae: 1.0000 (3.0331)  time: 0.2789  data: 0.0059  max mem: 6856
Test:  [190/228]  eta: 0:00:10  mae: 1.0000 (2.8796)  time: 0.2765  data: 0.0058  max mem: 6856
Test:  [200/228]  eta: 0:00:07  mae: 1.0000 (2.7413)  time: 0.2739  data: 0.0058  max mem: 6856
Test:  [210/228]  eta: 0:00:04  mae: 1.0000 (2.6445)  time: 0.2727  data: 0.0058  max mem: 6856
Test:  [220/228]  eta: 0:00:02  mae: 1.0000 (2.5792)  time: 0.2743  data: 0.0058  max mem: 6856
Test:  [227/228]  eta: 0:00:00  mae: 1.0000 (2.5395)  time: 0.2761  data: 0.0058  max mem: 6856
Test: Total time: 0:01:03 (0.2766 s / it)
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.2', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001) 

infer from: base_s4
inferring time: 63.0741s
FPS: 3.61
params: 50.065604
epoch: 1445			gt > 100 ended with 'ac' below:
mae 	 2.539473684210526	mae_ac 	 12.15
mse 	 7.740585679822081	mse_ac 	 24.270352284217054
Prec 	 0.9410525026164823	pre_ac 	 0.9304780288427669
Recall 	 0.9489693584139498	rec_ac 	 0.9178408842539835
F1_s 	 0.9421854802422183	f1_ac 	 0.9216061939499921
abs 	 0.05419390086087782	abs_ac 	 0.05760100951192996
r2 	 0.9834133082157612	r2_ac 	 0.9330855208619989
racc 	 0.9530398322851154	rac_ac 	 0.9301121656600517
rmae 	 5.3866294259815115	rmse 	 10.221335192986842
Finished eval with robust_para=1.2
----------------------------------------
Running eval with robust_para=1.4
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.4', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s4/best_checkpoint.pth
Traceback [1;36m(most recent call last)[0m:
[0m  File [0;32m/data/zlt/RemoteSensePET/eval_rebuild.py:143[0m
    main(args)[0m
[0m  File [0;32m/data/zlt/RemoteSensePET/eval_rebuild.py:98[0m in [0;35mmain[0m
    shutil.rmtree(vis_dir)[0m
[0m  File [0;32m~/ctf/anaconda3/envs/dinov2/lib/python3.9/shutil.py:740[0m in [0;35mrmtree[0m
    onerror(os.rmdir, path, sys.exc_info())[0m
[1;36m  File [1;32m~/ctf/anaconda3/envs/dinov2/lib/python3.9/shutil.py:738[1;36m in [1;35mrmtree[1;36m
[1;33m    os.rmdir(path)[1;36m
[1;31mOSError[0m[1;31m:[0m [Errno 39] Directory not empty: '/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis'

Finished eval with robust_para=1.4
----------------------------------------
Running eval with robust_para=1.6
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.6', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s4/best_checkpoint.pth
Test:  [  0/228]  eta: 0:10:25  mae: 9.0000 (9.0000)  time: 2.7429  data: 0.4221  max mem: 6590
Test:  [ 10/228]  eta: 0:02:42  mae: 2.0000 (3.4545)  time: 0.7435  data: 0.0443  max mem: 7657
Test:  [ 20/228]  eta: 0:01:51  mae: 1.0000 (2.7143)  time: 0.5339  data: 0.0253  max mem: 7657
Test:  [ 30/228]  eta: 0:01:49  mae: 2.0000 (2.8710)  time: 0.5511  data: 0.0193  max mem: 7657
Test:  [ 40/228]  eta: 0:01:34  mae: 2.0000 (2.7805)  time: 0.5015  data: 0.0158  max mem: 7657
Test:  [ 50/228]  eta: 0:01:36  mae: 2.0000 (2.7255)  time: 0.5418  data: 0.0140  max mem: 7657
Test:  [ 60/228]  eta: 0:01:25  mae: 2.0000 (2.6230)  time: 0.5095  data: 0.0125  max mem: 7657
Test:  [ 70/228]  eta: 0:01:19  mae: 2.0000 (2.4225)  time: 0.5004  data: 0.0116  max mem: 7657
Test:  [ 80/228]  eta: 0:01:11  mae: 1.0000 (2.2963)  time: 0.4822  data: 0.0109  max mem: 7657
Test:  [ 90/228]  eta: 0:01:03  mae: 1.0000 (2.1429)  time: 0.4621  data: 0.0104  max mem: 7657
Test:  [100/228]  eta: 0:00:57  mae: 1.0000 (2.0495)  time: 0.4476  data: 0.0100  max mem: 7657
Test:  [110/228]  eta: 0:00:51  mae: 1.0000 (2.0090)  time: 0.4375  data: 0.0096  max mem: 7657
Test:  [120/228]  eta: 0:00:46  mae: 1.0000 (1.9835)  time: 0.4288  data: 0.0093  max mem: 7657
Test:  [130/228]  eta: 0:00:41  mae: 1.0000 (2.0611)  time: 0.4201  data: 0.0090  max mem: 7657
Test:  [140/228]  eta: 0:00:36  mae: 1.0000 (1.9787)  time: 0.4128  data: 0.0088  max mem: 7657
Test:  [150/228]  eta: 0:00:31  mae: 1.0000 (1.9603)  time: 0.4078  data: 0.0086  max mem: 7657
Test:  [160/228]  eta: 0:00:28  mae: 1.0000 (2.0062)  time: 0.4121  data: 0.0084  max mem: 8721
Test:  [170/228]  eta: 0:00:24  mae: 1.0000 (2.2515)  time: 0.4288  data: 0.0084  max mem: 8721
Test:  [180/228]  eta: 0:00:22  mae: 1.0000 (2.5414)  time: 0.4705  data: 0.0083  max mem: 10584
Test:  [190/228]  eta: 0:00:17  mae: 1.0000 (2.4555)  time: 0.4666  data: 0.0083  max mem: 10584
Test:  [200/228]  eta: 0:00:12  mae: 1.0000 (2.3433)  time: 0.4620  data: 0.0083  max mem: 10584
Test:  [210/228]  eta: 0:00:08  mae: 1.0000 (2.2607)  time: 0.4591  data: 0.0082  max mem: 10584
Test:  [220/228]  eta: 0:00:03  mae: 1.0000 (2.2443)  time: 0.4599  data: 0.0082  max mem: 10584
Test:  [227/228]  eta: 0:00:00  mae: 1.0000 (2.2149)  time: 0.4606  data: 0.0082  max mem: 10584
Test: Total time: 0:01:45 (0.4611 s / it)
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.6', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001) 

infer from: base_s4
inferring time: 105.1560s
FPS: 2.17
params: 50.065604
epoch: 1445			gt > 100 ended with 'ac' below:
mae 	 2.2149122807017543	mae_ac 	 5.75
mse 	 3.971941060674703	mse_ac 	 8.351646544245034
Prec 	 0.9307756509272981	pre_ac 	 0.9326619617326054
Recall 	 0.9349960629382749	rec_ac 	 0.9417053979080141
F1_s 	 0.9308127602936558	f1_ac 	 0.9368451723902895
abs 	 0.06469441193298361	abs_ac 	 0.029564688247377225
r2 	 0.9805723961122905	r2_ac 	 0.9920765895596714
racc 	 0.9454926624737946	rac_ac 	 0.9669255104975554
rmae 	 6.807226997967658	rmse 	 12.318809983051734
Finished eval with robust_para=1.6
----------------------------------------
Running eval with robust_para=1.8
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.8', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s4/best_checkpoint.pth
Test:  [  0/228]  eta: 0:10:15  mae: 1.0000 (1.0000)  time: 2.6975  data: 0.4162  max mem: 8588
Test:  [ 10/228]  eta: 0:02:59  mae: 1.0000 (2.0909)  time: 0.8230  data: 0.0442  max mem: 9785
Test:  [ 20/228]  eta: 0:02:04  mae: 1.0000 (1.6190)  time: 0.5975  data: 0.0254  max mem: 9785
Test:  [ 30/228]  eta: 0:02:07  mae: 1.0000 (1.9032)  time: 0.6448  data: 0.0197  max mem: 9785
Test:  [ 40/228]  eta: 0:01:50  mae: 1.0000 (2.1463)  time: 0.5903  data: 0.0163  max mem: 9785
Test:  [ 50/228]  eta: 0:01:53  mae: 1.0000 (2.1373)  time: 0.6372  data: 0.0144  max mem: 9785
Test:  [ 60/228]  eta: 0:01:42  mae: 1.0000 (2.0820)  time: 0.6082  data: 0.0130  max mem: 9785
Test:  [ 70/228]  eta: 0:01:34  mae: 1.0000 (1.9859)  time: 0.6009  data: 0.0121  max mem: 9785
Test:  [ 80/228]  eta: 0:01:25  mae: 1.0000 (1.9012)  time: 0.5801  data: 0.0114  max mem: 9785
Test:  [ 90/228]  eta: 0:01:16  mae: 1.0000 (1.7912)  time: 0.5558  data: 0.0110  max mem: 9785
Test:  [100/228]  eta: 0:01:09  mae: 1.0000 (1.7327)  time: 0.5399  data: 0.0106  max mem: 9785
Test:  [110/228]  eta: 0:01:02  mae: 1.0000 (1.7207)  time: 0.5283  data: 0.0102  max mem: 9785
Test:  [120/228]  eta: 0:00:55  mae: 1.0000 (1.8430)  time: 0.5178  data: 0.0099  max mem: 9785
Test:  [130/228]  eta: 0:00:49  mae: 1.0000 (1.9924)  time: 0.5072  data: 0.0096  max mem: 9785
Test:  [140/228]  eta: 0:00:43  mae: 1.0000 (1.9220)  time: 0.4989  data: 0.0094  max mem: 9785
Test:  [150/228]  eta: 0:00:38  mae: 1.0000 (1.9338)  time: 0.4930  data: 0.0091  max mem: 9785
Test:  [160/228]  eta: 0:00:33  mae: 1.0000 (1.9689)  time: 0.4980  data: 0.0090  max mem: 10983
Test:  [170/228]  eta: 0:00:30  mae: 1.0000 (2.1871)  time: 0.5236  data: 0.0090  max mem: 10983
Test:  [180/228]  eta: 0:00:27  mae: 1.0000 (2.6354)  time: 0.5832  data: 0.0089  max mem: 13380
Test:  [190/228]  eta: 0:00:21  mae: 1.0000 (2.5288)  time: 0.5738  data: 0.0089  max mem: 13380
Test:  [200/228]  eta: 0:00:15  mae: 1.0000 (2.4080)  time: 0.5653  data: 0.0088  max mem: 13380
Test:  [210/228]  eta: 0:00:10  mae: 1.0000 (2.3365)  time: 0.5613  data: 0.0087  max mem: 13380
Test:  [220/228]  eta: 0:00:04  mae: 1.0000 (2.3303)  time: 0.5620  data: 0.0087  max mem: 13380
Test:  [227/228]  eta: 0:00:00  mae: 1.0000 (2.3026)  time: 0.5639  data: 0.0088  max mem: 13380
Test: Total time: 0:02:08 (0.5644 s / it)
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.8', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001) 

infer from: base_s4
inferring time: 128.6889s
FPS: 1.77
params: 50.065604
epoch: 1445			gt > 100 ended with 'ac' below:
mae 	 2.3026315789473686	mae_ac 	 6.1
mse 	 4.292486295434294	mse_ac 	 8.648699324175862
Prec 	 0.9355409027019976	pre_ac 	 0.9299186415717756
Recall 	 0.9199595708040715	rec_ac 	 0.9278065697196703
F1_s 	 0.9238398693162386	f1_ac 	 0.9285018233730804
abs 	 0.06572988199731108	abs_ac 	 0.03240393306204799
r2 	 0.976134573789167	r2_ac 	 0.9915029232840633
racc 	 0.943675751222921	rac_ac 	 0.9649122807017544
rmae 	 6.893430016416334	rmse 	 12.368060491037172
Finished eval with robust_para=1.8
----------------------------------------
Running eval with robust_para=2.0
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s4/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s4/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='2.0', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='panet', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=True, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s4', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', prob_bandwidth='dynamic', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='dysample', use_arc=True, use_spatial_attention=True, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s4/best_checkpoint.pth
Test:  [  0/228]  eta: 0:11:25  mae: 1.0000 (1.0000)  time: 3.0065  data: 0.4702  max mem: 9520
Test:  [ 10/228]  eta: 0:03:30  mae: 1.0000 (2.3636)  time: 0.9676  data: 0.0498  max mem: 10984
Test:  [ 20/228]  eta: 0:02:29  mae: 2.0000 (2.5238)  time: 0.7203  data: 0.0286  max mem: 10984
Test:  [ 30/228]  eta: 0:02:35  mae: 2.0000 (2.8065)  time: 0.7846  data: 0.0220  max mem: 10984
Test:  [ 40/228]  eta: 0:02:15  mae: 2.0000 (2.9756)  time: 0.7212  data: 0.0182  max mem: 10984
Test:  [ 50/228]  eta: 0:02:24  mae: 2.0000 (3.0196)  time: 0.8116  data: 0.0161  max mem: 10984
Test:  [ 60/228]  eta: 0:02:08  mae: 2.0000 (2.8197)  time: 0.7652  data: 0.0145  max mem: 10984
Test:  [ 70/228]  eta: 0:01:58  mae: 2.0000 (2.7183)  time: 0.7527  data: 0.0135  max mem: 10984
Test:  [ 80/228]  eta: 0:01:47  mae: 2.0000 (2.5802)  time: 0.7234  data: 0.0127  max mem: 10984
Test:  [ 90/228]  eta: 0:01:34  mae: 2.0000 (2.4176)  time: 0.6883  data: 0.0120  max mem: 10984
Test:  [100/228]  eta: 0:01:25  mae: 2.0000 (2.3168)  time: 0.6657  data: 0.0116  max mem: 10984
Test:  [110/228]  eta: 0:01:16  mae: 2.0000 (2.3604)  time: 0.6482  data: 0.0112  max mem: 10984
Test:  [120/228]  eta: 0:01:08  mae: 2.0000 (2.4876)  time: 0.6327  data: 0.0108  max mem: 10984
Test:  [130/228]  eta: 0:01:00  mae: 2.0000 (2.6641)  time: 0.6187  data: 0.0105  max mem: 10984
Test:  [140/228]  eta: 0:00:53  mae: 2.0000 (2.5887)  time: 0.6084  data: 0.0103  max mem: 10984
Test:  [150/228]  eta: 0:00:46  mae: 2.0000 (2.5166)  time: 0.6004  data: 0.0100  max mem: 10984
Test:  [160/228]  eta: 0:00:41  mae: 2.0000 (2.6335)  time: 0.6050  data: 0.0098  max mem: 13513
Test:  [170/228]  eta: 0:00:36  mae: 2.0000 (2.9649)  time: 0.6311  data: 0.0099  max mem: 13513
Traceback [1;36m(most recent call last)[0m:
[0m  File [0;32m/data/zlt/RemoteSensePET/eval_rebuild.py:143[0m
    main(args)[0m
[0m  File [0;32m/data/zlt/RemoteSensePET/eval_rebuild.py:103[0m in [0;35mmain[0m
    test_stats = evaluate(model, data_loader_val, device, vis_dir=vis_dir, args=args, criterion=criterion)[0m
[0m  File [0;32m~/ctf/anaconda3/envs/dinov2/lib/python3.9/site-packages/torch/utils/_contextlib.py:115[0m in [0;35mdecorate_context[0m
    return func(*args, **kwargs)[0m
[0m  File [0;32m/data/zlt/RemoteSensePET/engine.py:306[0m in [0;35mevaluate[0m
    outputs = model(samples, test=True, targets=targets, criterion=criterion, eval_s=True)[0m
[0m  File [0;32m~/ctf/anaconda3/envs/dinov2/lib/python3.9/site-packages/torch/nn/modules/module.py:1501[0m in [0;35m_call_impl[0m
    return forward_call(*args, **kwargs)[0m
[0m  File [0;32m/data/zlt/RemoteSensePET/models/pet.py:697[0m in [0;35mforward[0m
    dense_input_embed = self.pos_embed(samples)  # B*hidden_dim*imgH*imgW[0m
[0m  File [0;32m~/ctf/anaconda3/envs/dinov2/lib/python3.9/site-packages/torch/nn/modules/module.py:1501[0m in [0;35m_call_impl[0m
    return forward_call(*args, **kwargs)[0m
[1;36m  File [1;32m/data/zlt/RemoteSensePET/models/position_encoding.py:49[1;36m in [1;35mforward[1;36m
[1;33m    pos = torch.cat((pos_y, pos_x), dim=3).permute(0, 3, 1, 2)[1;36m
[1;31mOutOfMemoryError[0m[1;31m:[0m CUDA out of memory. Tried to allocate 7.50 GiB (GPU 0; 23.68 GiB total capacity; 8.30 GiB already allocated; 7.36 GiB free; 16.01 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

Finished eval with robust_para=2.0
----------------------------------------
