Running eval with robust_para=0.2
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.2', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
Traceback [1;36m(most recent call last)[0m:
[0m  File [0;32m/data/zlt/RemoteSensePET/eval_rebuild.py:143[0m
    main(args)[0m
[0m  File [0;32m/data/zlt/RemoteSensePET/eval_rebuild.py:61[0m in [0;35mmain[0m
    model, criterion = build_model(args)[0m
[0m  File [0;32m/data/zlt/RemoteSensePET/models/__init__.py:7[0m in [0;35mbuild_model[0m
    return build_pet(args)[0m
[1;36m  File [1;32m/data/zlt/RemoteSensePET/models/pet.py:1328[1;36m in [1;35mbuild_pet[1;36m
[1;33m    prob_fixed=args.prob_bandwidth)[1;36m
[1;31mAttributeError[0m[1;31m:[0m 'Namespace' object has no attribute 'prob_bandwidth'

Finished eval with robust_para=0.2
----------------------------------------
Running eval with robust_para=0.4
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.4', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
Traceback [1;36m(most recent call last)[0m:
[0m  File [0;32m/data/zlt/RemoteSensePET/eval_rebuild.py:143[0m
    main(args)[0m
[0m  File [0;32m/data/zlt/RemoteSensePET/eval_rebuild.py:61[0m in [0;35mmain[0m
    model, criterion = build_model(args)[0m
[0m  File [0;32m/data/zlt/RemoteSensePET/models/__init__.py:7[0m in [0;35mbuild_model[0m
    return build_pet(args)[0m
[1;36m  File [1;32m/data/zlt/RemoteSensePET/models/pet.py:1328[1;36m in [1;35mbuild_pet[1;36m
[1;33m    prob_fixed=args.prob_bandwidth)[1;36m
[1;31mAttributeError[0m[1;31m:[0m 'Namespace' object has no attribute 'prob_bandwidth'

Finished eval with robust_para=0.4
----------------------------------------
Running eval with robust_para=0.6
Running eval with robust_para=0.2
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.2', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s0/best_checkpoint.pth
Test:  [  0/228]  eta: 0:05:07  mae: 70.0000 (70.0000)  time: 1.3481  data: 0.1738  max mem: 349
Test:  [ 10/228]  eta: 0:00:35  mae: 70.0000 (73.8182)  time: 0.1650  data: 0.0180  max mem: 349
Test:  [ 20/228]  eta: 0:00:22  mae: 62.0000 (68.4286)  time: 0.1104  data: 0.0107  max mem: 349
Test:  [ 30/228]  eta: 0:00:17  mae: 62.0000 (69.4839)  time: 0.0903  data: 0.0080  max mem: 349
Test:  [ 40/228]  eta: 0:00:15  mae: 56.0000 (66.8049)  time: 0.0804  data: 0.0067  max mem: 349
Test:  [ 50/228]  eta: 0:00:13  mae: 63.0000 (75.0000)  time: 0.0744  data: 0.0059  max mem: 349
Test:  [ 60/228]  eta: 0:00:11  mae: 63.0000 (71.4590)  time: 0.0702  data: 0.0053  max mem: 349
Test:  [ 70/228]  eta: 0:00:10  mae: 62.0000 (68.9296)  time: 0.0678  data: 0.0050  max mem: 349
Test:  [ 80/228]  eta: 0:00:09  mae: 58.0000 (65.0000)  time: 0.0655  data: 0.0047  max mem: 349
Test:  [ 90/228]  eta: 0:00:08  mae: 48.0000 (59.3516)  time: 0.0634  data: 0.0044  max mem: 349
Test:  [100/228]  eta: 0:00:07  mae: 37.0000 (55.3267)  time: 0.0622  data: 0.0043  max mem: 349
Test:  [110/228]  eta: 0:00:07  mae: 36.0000 (53.0811)  time: 0.0615  data: 0.0042  max mem: 349
Test:  [120/228]  eta: 0:00:06  mae: 35.0000 (51.2066)  time: 0.0607  data: 0.0040  max mem: 349
Test:  [130/228]  eta: 0:00:05  mae: 31.0000 (48.9237)  time: 0.0596  data: 0.0039  max mem: 349
Test:  [140/228]  eta: 0:00:05  mae: 30.0000 (47.5248)  time: 0.0587  data: 0.0038  max mem: 349
Test:  [150/228]  eta: 0:00:04  mae: 29.0000 (46.5894)  time: 0.0581  data: 0.0037  max mem: 349
Test:  [160/228]  eta: 0:00:03  mae: 29.0000 (46.4783)  time: 0.0577  data: 0.0036  max mem: 349
Test:  [170/228]  eta: 0:00:03  mae: 27.0000 (46.6725)  time: 0.0582  data: 0.0036  max mem: 421
Test:  [180/228]  eta: 0:00:02  mae: 27.0000 (50.9613)  time: 0.0578  data: 0.0035  max mem: 421
Test:  [190/228]  eta: 0:00:02  mae: 25.0000 (48.5079)  time: 0.0573  data: 0.0035  max mem: 421
Test:  [200/228]  eta: 0:00:01  mae: 24.0000 (46.1891)  time: 0.0570  data: 0.0034  max mem: 421
Test:  [210/228]  eta: 0:00:01  mae: 24.0000 (44.1943)  time: 0.0566  data: 0.0034  max mem: 421
Test:  [220/228]  eta: 0:00:00  mae: 22.0000 (42.3982)  time: 0.0565  data: 0.0034  max mem: 421
Test:  [227/228]  eta: 0:00:00  mae: 15.0000 (41.2237)  time: 0.0564  data: 0.0033  max mem: 421
Test: Total time: 0:00:12 (0.0569 s / it)
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.2', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001) 

infer from: base_s0
inferring time: 12.9677s
FPS: 17.58
params: 37.660291
epoch: 555			gt > 100 ended with 'ac' below:
mae 	 41.223684210526315	mae_ac 	 170.75
mse 	 67.73850002742098	mse_ac 	 194.4714632021881
Prec 	 0.4149766743132774	pre_ac 	 0.18452380837496457
Recall 	 0.18715426959876091	rec_ac 	 0.010084379445675641
F1_s 	 0.2259567234854238	f1_ac 	 0.017170132321096217
abs 	 0.7812583503497305	abs_ac 	 0.9848028137000634
r2 	 -1.5567856022900357	r2_ac 	 -3.2961526588437904
racc 	 0.16366177498252965	rac_ac 	 0.017831463905665812
rmae 	 76.16867673352753	rmse 	 82.63812611851064
Finished eval with robust_para=0.2
----------------------------------------
Running eval with robust_para=0.4
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.4', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s0/best_checkpoint.pth
Test:  [  0/228]  eta: 0:05:38  mae: 8.0000 (8.0000)  time: 1.4850  data: 0.1940  max mem: 685
Test:  [ 10/228]  eta: 0:00:46  mae: 15.0000 (18.0909)  time: 0.2110  data: 0.0198  max mem: 685
Test:  [ 20/228]  eta: 0:00:30  mae: 13.0000 (15.8571)  time: 0.1470  data: 0.0115  max mem: 685
Test:  [ 30/228]  eta: 0:00:25  mae: 15.0000 (19.3548)  time: 0.1266  data: 0.0087  max mem: 685
Test:  [ 40/228]  eta: 0:00:21  mae: 19.0000 (20.2927)  time: 0.1118  data: 0.0072  max mem: 685
Test:  [ 50/228]  eta: 0:00:18  mae: 24.0000 (26.5490)  time: 0.1062  data: 0.0063  max mem: 685
Test:  [ 60/228]  eta: 0:00:16  mae: 24.0000 (27.3279)  time: 0.0994  data: 0.0058  max mem: 685
Test:  [ 70/228]  eta: 0:00:15  mae: 24.0000 (26.7465)  time: 0.0954  data: 0.0053  max mem: 685
Test:  [ 80/228]  eta: 0:00:13  mae: 19.0000 (23.8025)  time: 0.0936  data: 0.0050  max mem: 685
Test:  [ 90/228]  eta: 0:00:12  mae: 15.0000 (21.3626)  time: 0.0903  data: 0.0048  max mem: 685
Test:  [100/228]  eta: 0:00:11  mae: 13.0000 (19.5446)  time: 0.0888  data: 0.0046  max mem: 685
Test:  [110/228]  eta: 0:00:10  mae: 10.0000 (18.0541)  time: 0.0876  data: 0.0045  max mem: 685
Test:  [120/228]  eta: 0:00:09  mae: 5.0000 (16.7438)  time: 0.0867  data: 0.0043  max mem: 685
Test:  [130/228]  eta: 0:00:08  mae: 5.0000 (15.7786)  time: 0.0864  data: 0.0042  max mem: 685
Test:  [140/228]  eta: 0:00:07  mae: 4.0000 (14.9433)  time: 0.0852  data: 0.0041  max mem: 685
Test:  [150/228]  eta: 0:00:06  mae: 3.0000 (14.3046)  time: 0.0845  data: 0.0040  max mem: 685
Test:  [160/228]  eta: 0:00:05  mae: 3.0000 (13.9317)  time: 0.0845  data: 0.0039  max mem: 685
Test:  [170/228]  eta: 0:00:05  mae: 3.0000 (14.4620)  time: 0.0866  data: 0.0039  max mem: 953
Test:  [180/228]  eta: 0:00:04  mae: 3.0000 (15.4144)  time: 0.0905  data: 0.0039  max mem: 1218
Test:  [190/228]  eta: 0:00:03  mae: 3.0000 (14.6702)  time: 0.0889  data: 0.0038  max mem: 1218
Test:  [200/228]  eta: 0:00:02  mae: 3.0000 (13.9701)  time: 0.0876  data: 0.0038  max mem: 1218
Test:  [210/228]  eta: 0:00:01  mae: 3.0000 (13.3649)  time: 0.0869  data: 0.0038  max mem: 1218
Test:  [220/228]  eta: 0:00:00  mae: 2.0000 (12.8235)  time: 0.0867  data: 0.0037  max mem: 1218
Test:  [227/228]  eta: 0:00:00  mae: 2.0000 (12.4693)  time: 0.0865  data: 0.0037  max mem: 1218
Test: Total time: 0:00:19 (0.0870 s / it)
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.4', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001) 

infer from: base_s0
inferring time: 19.8533s
FPS: 11.48
params: 37.660291
epoch: 555			gt > 100 ended with 'ac' below:
mae 	 12.469298245614034	mae_ac 	 57.8
mse 	 23.270058316108443	mse_ac 	 64.32884267573915
Prec 	 0.8907604352570798	pre_ac 	 0.852894821888501
Recall 	 0.7436678751754346	rec_ac 	 0.5352282459243084
F1_s 	 0.7938241336216095	f1_ac 	 0.6398032227836585
abs 	 0.2084526978513726	abs_ac 	 0.3745256730990002
r2 	 0.6409422364132094	r2_ac 	 0.5299117263918578
racc 	 0.7642208245981831	rac_ac 	 0.6675294794362956
rmae 	 19.248414253910067	rmse 	 27.46602313864332
Finished eval with robust_para=0.4
----------------------------------------
Running eval with robust_para=0.6
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.6', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s0/best_checkpoint.pth
Test:  [  0/228]  eta: 0:05:48  mae: 10.0000 (10.0000)  time: 1.5292  data: 0.2156  max mem: 1352
Test:  [ 10/228]  eta: 0:00:56  mae: 3.0000 (5.8182)  time: 0.2606  data: 0.0220  max mem: 1352
Test:  [ 20/228]  eta: 0:00:38  mae: 3.0000 (4.5238)  time: 0.1848  data: 0.0129  max mem: 1352
Test:  [ 30/228]  eta: 0:00:33  mae: 3.0000 (4.1613)  time: 0.1709  data: 0.0097  max mem: 1352
Test:  [ 40/228]  eta: 0:00:28  mae: 3.0000 (4.5854)  time: 0.1538  data: 0.0080  max mem: 1352
Test:  [ 50/228]  eta: 0:00:27  mae: 3.0000 (5.3137)  time: 0.1562  data: 0.0070  max mem: 1352
Test:  [ 60/228]  eta: 0:00:24  mae: 4.0000 (5.6230)  time: 0.1463  data: 0.0063  max mem: 1352
Test:  [ 70/228]  eta: 0:00:22  mae: 4.0000 (5.2394)  time: 0.1413  data: 0.0058  max mem: 1352
Test:  [ 80/228]  eta: 0:00:19  mae: 3.0000 (4.7654)  time: 0.1339  data: 0.0054  max mem: 1352
Test:  [ 90/228]  eta: 0:00:17  mae: 3.0000 (4.3846)  time: 0.1264  data: 0.0051  max mem: 1352
Test:  [100/228]  eta: 0:00:15  mae: 3.0000 (4.1089)  time: 0.1209  data: 0.0048  max mem: 1352
Test:  [110/228]  eta: 0:00:13  mae: 2.0000 (3.8649)  time: 0.1169  data: 0.0046  max mem: 1352
Test:  [120/228]  eta: 0:00:12  mae: 2.0000 (3.6777)  time: 0.1141  data: 0.0045  max mem: 1352
Test:  [130/228]  eta: 0:00:10  mae: 2.0000 (3.5878)  time: 0.1117  data: 0.0043  max mem: 1352
Test:  [140/228]  eta: 0:00:09  mae: 2.0000 (3.4184)  time: 0.1090  data: 0.0042  max mem: 1352
Test:  [150/228]  eta: 0:00:08  mae: 2.0000 (3.3179)  time: 0.1069  data: 0.0041  max mem: 1352
Test:  [160/228]  eta: 0:00:07  mae: 2.0000 (3.3292)  time: 0.1065  data: 0.0040  max mem: 1352
Test:  [170/228]  eta: 0:00:06  mae: 2.0000 (3.5614)  time: 0.1100  data: 0.0040  max mem: 1750
Test:  [180/228]  eta: 0:00:05  mae: 2.0000 (4.3923)  time: 0.1169  data: 0.0039  max mem: 2152
Test:  [190/228]  eta: 0:00:04  mae: 2.0000 (4.1990)  time: 0.1146  data: 0.0039  max mem: 2152
Test:  [200/228]  eta: 0:00:03  mae: 2.0000 (4.0000)  time: 0.1126  data: 0.0038  max mem: 2152
Test:  [210/228]  eta: 0:00:02  mae: 1.0000 (3.8673)  time: 0.1113  data: 0.0038  max mem: 2152
Test:  [220/228]  eta: 0:00:00  mae: 1.0000 (3.7376)  time: 0.1113  data: 0.0038  max mem: 2152
Test:  [227/228]  eta: 0:00:00  mae: 1.0000 (3.6535)  time: 0.1111  data: 0.0037  max mem: 2152
Test: Total time: 0:00:25 (0.1115 s / it)
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.6', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001) 

infer from: base_s0
inferring time: 25.4284s
FPS: 8.97
params: 37.660291
epoch: 555			gt > 100 ended with 'ac' below:
mae 	 3.6535087719298245	mae_ac 	 15.2
mse 	 9.982221037529937	mse_ac 	 30.903074280724887
Prec 	 0.9118614845504424	pre_ac 	 0.8749246911116142
Recall 	 0.8935832647271461	rec_ac 	 0.8143816253428836
F1_s 	 0.9000750192169392	f1_ac 	 0.8407714773803422
abs 	 0.07787840146007369	abs_ac 	 0.07765237279236872
r2 	 0.9680706183153404	r2_ac 	 0.8915145954048196
racc 	 0.9260656883298393	rac_ac 	 0.912568306010929
rmae 	 7.790013498581459	rmse 	 13.09278163225967
Finished eval with robust_para=0.6
----------------------------------------
Running eval with robust_para=0.8
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.8', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s0/best_checkpoint.pth
Test:  [  0/228]  eta: 0:06:12  mae: 4.0000 (4.0000)  time: 1.6331  data: 0.2152  max mem: 1750
Test:  [ 10/228]  eta: 0:01:08  mae: 2.0000 (3.0000)  time: 0.3149  data: 0.0224  max mem: 2284
Test:  [ 20/228]  eta: 0:00:47  mae: 2.0000 (2.5238)  time: 0.2282  data: 0.0132  max mem: 2284
Test:  [ 30/228]  eta: 0:00:42  mae: 2.0000 (2.2581)  time: 0.2142  data: 0.0099  max mem: 2284
Test:  [ 40/228]  eta: 0:00:36  mae: 2.0000 (2.5366)  time: 0.1937  data: 0.0082  max mem: 2284
Test:  [ 50/228]  eta: 0:00:36  mae: 2.0000 (2.8235)  time: 0.2027  data: 0.0073  max mem: 2284
Test:  [ 60/228]  eta: 0:00:31  mae: 2.0000 (2.6557)  time: 0.1899  data: 0.0066  max mem: 2284
Test:  [ 70/228]  eta: 0:00:29  mae: 2.0000 (2.4648)  time: 0.1851  data: 0.0062  max mem: 2284
Test:  [ 80/228]  eta: 0:00:26  mae: 2.0000 (2.2840)  time: 0.1777  data: 0.0058  max mem: 2284
Test:  [ 90/228]  eta: 0:00:23  mae: 2.0000 (2.1538)  time: 0.1693  data: 0.0055  max mem: 2284
Test:  [100/228]  eta: 0:00:20  mae: 1.0000 (1.9901)  time: 0.1628  data: 0.0052  max mem: 2284
Test:  [110/228]  eta: 0:00:18  mae: 1.0000 (1.9459)  time: 0.1584  data: 0.0051  max mem: 2284
Test:  [120/228]  eta: 0:00:16  mae: 1.0000 (1.9091)  time: 0.1550  data: 0.0049  max mem: 2284
Test:  [130/228]  eta: 0:00:14  mae: 1.0000 (1.9084)  time: 0.1515  data: 0.0048  max mem: 2284
Test:  [140/228]  eta: 0:00:13  mae: 1.0000 (1.8582)  time: 0.1485  data: 0.0047  max mem: 2284
Test:  [150/228]  eta: 0:00:11  mae: 1.0000 (1.7748)  time: 0.1465  data: 0.0046  max mem: 2284
Test:  [160/228]  eta: 0:00:09  mae: 1.0000 (1.7888)  time: 0.1467  data: 0.0045  max mem: 2284
Test:  [170/228]  eta: 0:00:08  mae: 1.0000 (2.0292)  time: 0.1505  data: 0.0044  max mem: 2816
Test:  [180/228]  eta: 0:00:07  mae: 1.0000 (3.2983)  time: 0.1596  data: 0.0044  max mem: 2949
Test:  [190/228]  eta: 0:00:05  mae: 1.0000 (3.1466)  time: 0.1570  data: 0.0043  max mem: 2949
Test:  [200/228]  eta: 0:00:04  mae: 1.0000 (3.0050)  time: 0.1544  data: 0.0043  max mem: 2949
Test:  [210/228]  eta: 0:00:02  mae: 1.0000 (2.9100)  time: 0.1527  data: 0.0042  max mem: 2949
Test:  [220/228]  eta: 0:00:01  mae: 1.0000 (2.8326)  time: 0.1518  data: 0.0042  max mem: 2949
Test:  [227/228]  eta: 0:00:00  mae: 1.0000 (2.8070)  time: 0.1511  data: 0.0042  max mem: 2949
Test: Total time: 0:00:34 (0.1515 s / it)
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='0.8', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001) 

infer from: base_s0
inferring time: 34.5531s
FPS: 6.60
params: 37.660291
epoch: 555			gt > 100 ended with 'ac' below:
mae 	 2.807017543859649	mae_ac 	 15.1
mse 	 10.718896251112112	mse_ac 	 35.104130811059825
Prec 	 0.9225263709851316	pre_ac 	 0.902357185813548
Recall 	 0.9234283969150604	rec_ac 	 0.8676591506257022
F1_s 	 0.9208822581758856	f1_ac 	 0.8810349487746103
abs 	 0.06111298788065734	abs_ac 	 0.06675490572318439
r2 	 0.9863248019863988	r2_ac 	 0.8600140690234127
racc 	 0.9527603074772886	rac_ac 	 0.913143514524015
rmae 	 6.05704957804144	rmse 	 12.425867979247993
Finished eval with robust_para=0.8
----------------------------------------
Running eval with robust_para=1.0
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.0', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s0/best_checkpoint.pth
Traceback [1;36m(most recent call last)[0m:
[0m  File [0;32m/data/zlt/RemoteSensePET/eval_rebuild.py:143[0m
    main(args)[0m
[0m  File [0;32m/data/zlt/RemoteSensePET/eval_rebuild.py:98[0m in [0;35mmain[0m
    shutil.rmtree(vis_dir)[0m
[0m  File [0;32m~/ctf/anaconda3/envs/dinov2/lib/python3.9/shutil.py:740[0m in [0;35mrmtree[0m
    onerror(os.rmdir, path, sys.exc_info())[0m
[1;36m  File [1;32m~/ctf/anaconda3/envs/dinov2/lib/python3.9/shutil.py:738[1;36m in [1;35mrmtree[1;36m
[1;33m    os.rmdir(path)[1;36m
[1;31mOSError[0m[1;31m:[0m [Errno 39] Directory not empty: '/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis'

Finished eval with robust_para=1.0
----------------------------------------
Running eval with robust_para=1.2
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.2', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s0/best_checkpoint.pth
Test:  [  0/228]  eta: 0:07:19  mae: 7.0000 (7.0000)  time: 1.9296  data: 0.2913  max mem: 4148
Test:  [ 10/228]  eta: 0:01:41  mae: 2.0000 (3.6364)  time: 0.4652  data: 0.0305  max mem: 4946
Test:  [ 20/228]  eta: 0:01:09  mae: 1.0000 (2.6667)  time: 0.3360  data: 0.0177  max mem: 4946
Test:  [ 30/228]  eta: 0:01:08  mae: 2.0000 (3.0645)  time: 0.3477  data: 0.0135  max mem: 4946
Test:  [ 40/228]  eta: 0:00:59  mae: 2.0000 (3.0244)  time: 0.3164  data: 0.0113  max mem: 4946
Test:  [ 50/228]  eta: 0:00:59  mae: 2.0000 (3.1176)  time: 0.3356  data: 0.0100  max mem: 4946
Test:  [ 60/228]  eta: 0:00:52  mae: 2.0000 (2.8525)  time: 0.3154  data: 0.0091  max mem: 4946
Test:  [ 70/228]  eta: 0:00:48  mae: 2.0000 (2.5352)  time: 0.3086  data: 0.0084  max mem: 4946
Test:  [ 80/228]  eta: 0:00:44  mae: 1.0000 (2.3580)  time: 0.2985  data: 0.0079  max mem: 4946
Test:  [ 90/228]  eta: 0:00:39  mae: 1.0000 (2.1978)  time: 0.2842  data: 0.0075  max mem: 4946
Test:  [100/228]  eta: 0:00:35  mae: 1.0000 (2.0693)  time: 0.2745  data: 0.0072  max mem: 4946
Test:  [110/228]  eta: 0:00:31  mae: 1.0000 (1.9730)  time: 0.2682  data: 0.0069  max mem: 4946
Test:  [120/228]  eta: 0:00:28  mae: 1.0000 (1.9669)  time: 0.2632  data: 0.0067  max mem: 4946
Test:  [130/228]  eta: 0:00:25  mae: 1.0000 (2.0076)  time: 0.2579  data: 0.0065  max mem: 4946
Test:  [140/228]  eta: 0:00:22  mae: 1.0000 (1.9362)  time: 0.2535  data: 0.0063  max mem: 4946
Test:  [150/228]  eta: 0:00:19  mae: 1.0000 (1.9272)  time: 0.2513  data: 0.0062  max mem: 4946
Test:  [160/228]  eta: 0:00:17  mae: 1.0000 (1.9814)  time: 0.2529  data: 0.0060  max mem: 4946
Test:  [170/228]  eta: 0:00:15  mae: 1.0000 (2.2281)  time: 0.2617  data: 0.0060  max mem: 4946
Test:  [180/228]  eta: 0:00:13  mae: 1.0000 (3.1878)  time: 0.2811  data: 0.0060  max mem: 6810
Test:  [190/228]  eta: 0:00:10  mae: 1.0000 (3.0524)  time: 0.2769  data: 0.0059  max mem: 6810
Test:  [200/228]  eta: 0:00:07  mae: 1.0000 (2.9154)  time: 0.2727  data: 0.0058  max mem: 6810
Test:  [210/228]  eta: 0:00:04  mae: 1.0000 (2.8436)  time: 0.2703  data: 0.0058  max mem: 6810
Test:  [220/228]  eta: 0:00:02  mae: 1.0000 (2.7692)  time: 0.2705  data: 0.0058  max mem: 6810
Test:  [227/228]  eta: 0:00:00  mae: 1.0000 (2.7193)  time: 0.2714  data: 0.0058  max mem: 6810
Test: Total time: 0:01:01 (0.2719 s / it)
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.2', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001) 

infer from: base_s0
inferring time: 62.0008s
FPS: 3.68
params: 37.660291
epoch: 555			gt > 100 ended with 'ac' below:
mae 	 2.719298245614035	mae_ac 	 12.85
mse 	 8.162279523365019	mse_ac 	 26.16199533674754
Prec 	 0.9302513205126459	pre_ac 	 0.9239945053564993
Recall 	 0.9308220604548659	rec_ac 	 0.8982087060496926
F1_s 	 0.9290270654430339	f1_ac 	 0.9088997989971561
abs 	 0.060721197370676966	abs_ac 	 0.057491963169119566
r2 	 0.9867571146977966	r2_ac 	 0.9222483401307107
racc 	 0.949266247379455	rac_ac 	 0.9260857060684498
rmae 	 6.103170065928828	rmse 	 11.349134128493727
Finished eval with robust_para=1.2
----------------------------------------
Running eval with robust_para=1.4
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.4', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s0/best_checkpoint.pth
Test:  [  0/228]  eta: 0:07:40  mae: 3.0000 (3.0000)  time: 2.0189  data: 0.3135  max mem: 4812
Test:  [ 10/228]  eta: 0:01:56  mae: 1.0000 (2.6364)  time: 0.5327  data: 0.0330  max mem: 5744
Test:  [ 20/228]  eta: 0:01:19  mae: 1.0000 (2.1429)  time: 0.3834  data: 0.0192  max mem: 5744
Test:  [ 30/228]  eta: 0:01:19  mae: 1.0000 (2.2258)  time: 0.4000  data: 0.0147  max mem: 5744
Test:  [ 40/228]  eta: 0:01:08  mae: 1.0000 (2.1707)  time: 0.3652  data: 0.0121  max mem: 5744
Test:  [ 50/228]  eta: 0:01:11  mae: 1.0000 (2.2941)  time: 0.3996  data: 0.0108  max mem: 5744
Test:  [ 60/228]  eta: 0:01:03  mae: 1.0000 (2.2787)  time: 0.3802  data: 0.0097  max mem: 5744
Test:  [ 70/228]  eta: 0:00:58  mae: 1.0000 (2.1408)  time: 0.3727  data: 0.0091  max mem: 5744
Test:  [ 80/228]  eta: 0:00:52  mae: 1.0000 (1.9753)  time: 0.3558  data: 0.0085  max mem: 5744
Test:  [ 90/228]  eta: 0:00:46  mae: 1.0000 (1.8571)  time: 0.3374  data: 0.0080  max mem: 5744
Test:  [100/228]  eta: 0:00:41  mae: 1.0000 (1.7525)  time: 0.3234  data: 0.0077  max mem: 5744
Test:  [110/228]  eta: 0:00:37  mae: 1.0000 (1.7838)  time: 0.3136  data: 0.0074  max mem: 5744
Test:  [120/228]  eta: 0:00:32  mae: 1.0000 (1.8430)  time: 0.3052  data: 0.0072  max mem: 5744
Test:  [130/228]  eta: 0:00:29  mae: 1.0000 (1.9313)  time: 0.2971  data: 0.0070  max mem: 5744
Test:  [140/228]  eta: 0:00:25  mae: 1.0000 (1.8652)  time: 0.2906  data: 0.0068  max mem: 5744
Test:  [150/228]  eta: 0:00:22  mae: 1.0000 (1.8278)  time: 0.2859  data: 0.0066  max mem: 5744
Test:  [160/228]  eta: 0:00:19  mae: 1.0000 (1.9876)  time: 0.2866  data: 0.0065  max mem: 6676
Test:  [170/228]  eta: 0:00:17  mae: 1.0000 (2.1637)  time: 0.2990  data: 0.0065  max mem: 6676
Test:  [180/228]  eta: 0:00:15  mae: 1.0000 (2.3978)  time: 0.3302  data: 0.0064  max mem: 7609
Test:  [190/228]  eta: 0:00:12  mae: 1.0000 (2.3089)  time: 0.3255  data: 0.0064  max mem: 7609
Test:  [200/228]  eta: 0:00:08  mae: 1.0000 (2.2139)  time: 0.3207  data: 0.0064  max mem: 7609
Test:  [210/228]  eta: 0:00:05  mae: 1.0000 (2.1659)  time: 0.3180  data: 0.0063  max mem: 7609
Test:  [220/228]  eta: 0:00:02  mae: 1.0000 (2.1403)  time: 0.3202  data: 0.0064  max mem: 7609
Test:  [227/228]  eta: 0:00:00  mae: 1.0000 (2.1184)  time: 0.3229  data: 0.0064  max mem: 7609
Test: Total time: 0:01:13 (0.3234 s / it)
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.4', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001) 

infer from: base_s0
inferring time: 73.7547s
FPS: 3.09
params: 37.660291
epoch: 555			gt > 100 ended with 'ac' below:
mae 	 2.1184210526315788	mae_ac 	 5.45
mse 	 3.6986246851233107	mse_ac 	 8.743569065318807
Prec 	 0.9328614092400145	pre_ac 	 0.9209119057404063
Recall 	 0.9169116753247571	rec_ac 	 0.9051083001842205
F1_s 	 0.9227736259374534	f1_ac 	 0.9126274035298361
abs 	 0.06430965891752773	abs_ac 	 0.02905282140854361
r2 	 0.985971893650564	r2_ac 	 0.9913154877682706
racc 	 0.9477288609364081	rac_ac 	 0.9686511360368133
rmae 	 6.769973944723777	rmse 	 11.979641674713209
Finished eval with robust_para=1.4
----------------------------------------
Running eval with robust_para=1.6
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.6', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s0/best_checkpoint.pth
Test:  [  0/228]  eta: 0:08:20  mae: 0.0000 (0.0000)  time: 2.1945  data: 0.3387  max mem: 6543
Test:  [ 10/228]  eta: 0:02:17  mae: 1.0000 (2.7273)  time: 0.6320  data: 0.0360  max mem: 7611
Test:  [ 20/228]  eta: 0:01:37  mae: 1.0000 (2.1429)  time: 0.4670  data: 0.0209  max mem: 7611
Test:  [ 30/228]  eta: 0:01:36  mae: 2.0000 (2.4839)  time: 0.4898  data: 0.0162  max mem: 7611
Test:  [ 40/228]  eta: 0:01:24  mae: 2.0000 (2.3659)  time: 0.4509  data: 0.0134  max mem: 7611
Test:  [ 50/228]  eta: 0:01:27  mae: 2.0000 (2.5490)  time: 0.4905  data: 0.0120  max mem: 7611
Test:  [ 60/228]  eta: 0:01:17  mae: 2.0000 (2.5082)  time: 0.4626  data: 0.0108  max mem: 7611
Test:  [ 70/228]  eta: 0:01:12  mae: 1.0000 (2.2958)  time: 0.4558  data: 0.0101  max mem: 7611
Test:  [ 80/228]  eta: 0:01:05  mae: 1.0000 (2.2346)  time: 0.4417  data: 0.0096  max mem: 7611
Test:  [ 90/228]  eta: 0:00:58  mae: 1.0000 (2.1099)  time: 0.4231  data: 0.0092  max mem: 7611
Test:  [100/228]  eta: 0:00:52  mae: 1.0000 (2.0396)  time: 0.4098  data: 0.0088  max mem: 7611
Test:  [110/228]  eta: 0:00:47  mae: 1.0000 (2.0450)  time: 0.4011  data: 0.0085  max mem: 7611
Test:  [120/228]  eta: 0:00:42  mae: 1.0000 (2.1736)  time: 0.3941  data: 0.0083  max mem: 7611
Test:  [130/228]  eta: 0:00:37  mae: 2.0000 (2.3282)  time: 0.3862  data: 0.0081  max mem: 7611
Test:  [140/228]  eta: 0:00:33  mae: 2.0000 (2.2482)  time: 0.3804  data: 0.0079  max mem: 7611
Test:  [150/228]  eta: 0:00:29  mae: 1.0000 (2.2384)  time: 0.3761  data: 0.0078  max mem: 7611
Test:  [160/228]  eta: 0:00:25  mae: 2.0000 (2.4286)  time: 0.3803  data: 0.0076  max mem: 8673
Test:  [170/228]  eta: 0:00:23  mae: 2.0000 (2.6082)  time: 0.3971  data: 0.0076  max mem: 8673
Test:  [180/228]  eta: 0:00:21  mae: 2.0000 (2.8729)  time: 0.4395  data: 0.0076  max mem: 10537
Test:  [190/228]  eta: 0:00:16  mae: 2.0000 (2.7801)  time: 0.4340  data: 0.0076  max mem: 10537
Test:  [200/228]  eta: 0:00:11  mae: 1.0000 (2.6667)  time: 0.4284  data: 0.0076  max mem: 10537
Test:  [210/228]  eta: 0:00:07  mae: 1.0000 (2.5924)  time: 0.4257  data: 0.0075  max mem: 10537
Test:  [220/228]  eta: 0:00:03  mae: 1.0000 (2.5475)  time: 0.4265  data: 0.0076  max mem: 10537
Test:  [227/228]  eta: 0:00:00  mae: 1.0000 (2.5132)  time: 0.4270  data: 0.0076  max mem: 10537
Test: Total time: 0:01:37 (0.4275 s / it)
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.6', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001) 

infer from: base_s0
inferring time: 97.4804s
FPS: 2.34
params: 37.660291
epoch: 555			gt > 100 ended with 'ac' below:
mae 	 2.513157894736842	mae_ac 	 5.45
mse 	 4.100171156033847	mse_ac 	 7.256031973468694
Prec 	 0.9315393696516178	pre_ac 	 0.9184239200784166
Recall 	 0.9010171249027542	rec_ac 	 0.9122873498022951
F1_s 	 0.9134162012929309	f1_ac 	 0.9149788619658162
abs 	 0.0758684153341926	abs_ac 	 0.031941704129572035
r2 	 0.9754728706594766	r2_ac 	 0.9940191030869777
racc 	 0.9351502445842068	rac_ac 	 0.9686511360368133
rmae 	 8.009213756540616	rmse 	 13.170740071158841
Finished eval with robust_para=1.6
----------------------------------------
Running eval with robust_para=1.8
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.8', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s0/best_checkpoint.pth
Test:  [  0/228]  eta: 0:09:25  mae: 2.0000 (2.0000)  time: 2.4824  data: 0.4014  max mem: 8541
Test:  [ 10/228]  eta: 0:02:40  mae: 2.0000 (2.8182)  time: 0.7365  data: 0.0425  max mem: 9738
Test:  [ 20/228]  eta: 0:01:52  mae: 2.0000 (2.2857)  time: 0.5393  data: 0.0245  max mem: 9738
Test:  [ 30/228]  eta: 0:01:54  mae: 1.0000 (2.8710)  time: 0.5793  data: 0.0189  max mem: 9738
Test:  [ 40/228]  eta: 0:01:40  mae: 1.0000 (2.9024)  time: 0.5343  data: 0.0157  max mem: 9738
Test:  [ 50/228]  eta: 0:01:43  mae: 2.0000 (3.0784)  time: 0.5814  data: 0.0139  max mem: 9738
Test:  [ 60/228]  eta: 0:01:33  mae: 2.0000 (3.0328)  time: 0.5559  data: 0.0126  max mem: 9738
Test:  [ 70/228]  eta: 0:01:27  mae: 2.0000 (2.8310)  time: 0.5517  data: 0.0119  max mem: 9738
Test:  [ 80/228]  eta: 0:01:18  mae: 2.0000 (2.7407)  time: 0.5333  data: 0.0113  max mem: 9738
Test:  [ 90/228]  eta: 0:01:10  mae: 1.0000 (2.5165)  time: 0.5095  data: 0.0108  max mem: 9738
Test:  [100/228]  eta: 0:01:03  mae: 1.0000 (2.5149)  time: 0.4927  data: 0.0105  max mem: 9738
Test:  [110/228]  eta: 0:00:56  mae: 1.0000 (2.4505)  time: 0.4814  data: 0.0102  max mem: 9738
Test:  [120/228]  eta: 0:00:51  mae: 2.0000 (2.6033)  time: 0.4728  data: 0.0100  max mem: 9738
Test:  [130/228]  eta: 0:00:45  mae: 2.0000 (2.8779)  time: 0.4635  data: 0.0098  max mem: 9738
Test:  [140/228]  eta: 0:00:40  mae: 2.0000 (2.8085)  time: 0.4573  data: 0.0096  max mem: 9738
Test:  [150/228]  eta: 0:00:35  mae: 2.0000 (2.8344)  time: 0.4530  data: 0.0095  max mem: 9738
Test:  [160/228]  eta: 0:00:31  mae: 2.0000 (3.0497)  time: 0.4577  data: 0.0093  max mem: 10936
Test:  [170/228]  eta: 0:00:27  mae: 2.0000 (3.2865)  time: 0.4804  data: 0.0094  max mem: 10936
Test:  [180/228]  eta: 0:00:25  mae: 2.0000 (3.6685)  time: 0.5384  data: 0.0094  max mem: 13332
Test:  [190/228]  eta: 0:00:20  mae: 2.0000 (3.5445)  time: 0.5300  data: 0.0093  max mem: 13332
Test:  [200/228]  eta: 0:00:14  mae: 2.0000 (3.3980)  time: 0.5217  data: 0.0092  max mem: 13332
Test:  [210/228]  eta: 0:00:09  mae: 2.0000 (3.3270)  time: 0.5166  data: 0.0092  max mem: 13332
Test:  [220/228]  eta: 0:00:04  mae: 2.0000 (3.2805)  time: 0.5172  data: 0.0092  max mem: 13332
Test:  [227/228]  eta: 0:00:00  mae: 2.0000 (3.2412)  time: 0.5192  data: 0.0092  max mem: 13332
Test: Total time: 0:01:58 (0.5197 s / it)
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='1.8', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001) 

infer from: base_s0
inferring time: 118.5079s
FPS: 1.92
params: 37.660291
epoch: 555			gt > 100 ended with 'ac' below:
mae 	 3.241228070175439	mae_ac 	 6.8
mse 	 5.142274054943042	mse_ac 	 9.99499874937461
Prec 	 0.9350308522560803	pre_ac 	 0.9300015907699049
Recall 	 0.8835299024301556	rec_ac 	 0.9109197631324498
F1_s 	 0.9041921351906632	f1_ac 	 0.9197711778557875
abs 	 0.0975515835049903	abs_ac 	 0.04018615525743545
r2 	 0.9644356624562411	r2_ac 	 0.988651631498368
racc 	 0.9157232704402516	rac_ac 	 0.9608858211101524
rmae 	 10.306749006725521	rmse 	 16.248180858434875
Finished eval with robust_para=1.8
----------------------------------------
Running eval with robust_para=2.0
Not using distributed mode
Namespace(cfg='outputs/RS/Car/base_s0/config.yaml', gt_determined='100', device='cuda', resume='outputs/RS/Car/base_s0/best_checkpoint.pth', vis_dir='/data/zlt/RemoteSensePET/outputs/Ship/t_noencoder_attn_opre_bs16_withen_box1_layer6/vis', eval_pad='padding_center', eval_robust='scale', robust_para='2.0', prob_map_lc=None, world_size=1, dist_url='env://', Orattn=True, prob_bandwidth='dynamic', attn_splitter=True, attn_type='softmax', augmented=False, backbone='swin_t', backbone_num_channels=512, batch_size=8, box_setting=1, ce_loss_coef=1.0, clip_max_norm=0.1, context_patch=[64, 32], data_path='data/Car', dataset_file='Car', dec_layers=2, dense_dec_win_size=[4, 2], dense_stride=8, dim_feedforward=512, dist_backend='nccl', distributed=False, dropout=0.0, enc_win_list=[[16, 8], [16, 8], [8, 4], [8, 4]], encoder_free=True, eos_coef=0.5, epochs=1500, eval_freq=5, fpn_type='original', global_crop_ratio=0.1, gpu=0, hidden_dim=256, loss_f='normal', lr=0.0001, lr_backbone=1e-05, map_loss_coef=1.0, matcher='hun', nheads=8, num_workers=2, one_key_hfy=False, one_key_zlt=False, opt_query_con=False, opt_query_decoder=False, output_dir='base_s0', patch_size=256, point_loss_coef=5.0, position_embedding='sine', predict='origin', rank=0, save_ckpt_freq=1000, seed=3407, set_cost_class=1, set_cost_point=0.05, sparse_dec_win_size=[8, 4], sparse_stride=16, start_epoch=0, syn_bn=0, upsample_strategy='bilinear', use_arc=False, use_spatial_attention=False, weight_decay=0.0001)
build swin backbone
building PET without encoder
context_patch: [64, 32]
attn splitter
using detr object query for decoder
robust testing: scale
scaling test
static global crop ratio
load successfully from ckpt: outputs/RS/Car/base_s0/best_checkpoint.pth
Test:  [  0/228]  eta: 0:09:42  mae: 10.0000 (10.0000)  time: 2.5550  data: 0.4335  max mem: 9473
Test:  [ 10/228]  eta: 0:03:05  mae: 2.0000 (6.0000)  time: 0.8530  data: 0.0460  max mem: 10936
Test:  [ 20/228]  eta: 0:02:12  mae: 1.0000 (3.5714)  time: 0.6394  data: 0.0266  max mem: 10936
Test:  [ 30/228]  eta: 0:02:16  mae: 2.0000 (4.4516)  time: 0.6882  data: 0.0207  max mem: 10936
Test:  [ 40/228]  eta: 0:01:59  mae: 1.0000 (4.0244)  time: 0.6350  data: 0.0171  max mem: 10936
Test:  [ 50/228]  eta: 0:02:03  mae: 2.0000 (4.6863)  time: 0.6913  data: 0.0152  max mem: 10936
Test:  [ 60/228]  eta: 0:01:50  mae: 2.0000 (4.3279)  time: 0.6561  data: 0.0138  max mem: 10936
Test:  [ 70/228]  eta: 0:01:42  mae: 2.0000 (3.9437)  time: 0.6497  data: 0.0129  max mem: 10936
Test:  [ 80/228]  eta: 0:01:32  mae: 2.0000 (3.8765)  time: 0.6253  data: 0.0121  max mem: 10936
Test:  [ 90/228]  eta: 0:01:22  mae: 2.0000 (3.6374)  time: 0.5961  data: 0.0116  max mem: 10936
Test:  [100/228]  eta: 0:01:13  mae: 2.0000 (3.6238)  time: 0.5748  data: 0.0111  max mem: 10936
Test:  [110/228]  eta: 0:01:06  mae: 2.0000 (3.6126)  time: 0.5614  data: 0.0107  max mem: 10936
Test:  [120/228]  eta: 0:00:59  mae: 2.0000 (3.8017)  time: 0.5493  data: 0.0104  max mem: 10936
Test:  [130/228]  eta: 0:00:52  mae: 3.0000 (4.0916)  time: 0.5367  data: 0.0101  max mem: 10936
Test:  [140/228]  eta: 0:00:46  mae: 3.0000 (3.9716)  time: 0.5279  data: 0.0099  max mem: 10936
Test:  [150/228]  eta: 0:00:40  mae: 3.0000 (4.0132)  time: 0.5233  data: 0.0097  max mem: 10936
Test:  [160/228]  eta: 0:00:35  mae: 3.0000 (4.2360)  time: 0.5284  data: 0.0096  max mem: 13465
Test:  [170/228]  eta: 0:00:32  mae: 3.0000 (4.4912)  time: 0.5570  data: 0.0096  max mem: 13465
Traceback [1;36m(most recent call last)[0m:
[0m  File [0;32m/data/zlt/RemoteSensePET/eval_rebuild.py:143[0m
    main(args)[0m
[0m  File [0;32m/data/zlt/RemoteSensePET/eval_rebuild.py:103[0m in [0;35mmain[0m
    test_stats = evaluate(model, data_loader_val, device, vis_dir=vis_dir, args=args, criterion=criterion)[0m
[0m  File [0;32m~/ctf/anaconda3/envs/dinov2/lib/python3.9/site-packages/torch/utils/_contextlib.py:115[0m in [0;35mdecorate_context[0m
    return func(*args, **kwargs)[0m
[0m  File [0;32m/data/zlt/RemoteSensePET/engine.py:306[0m in [0;35mevaluate[0m
    outputs = model(samples, test=True, targets=targets, criterion=criterion, eval_s=True)[0m
[0m  File [0;32m~/ctf/anaconda3/envs/dinov2/lib/python3.9/site-packages/torch/nn/modules/module.py:1501[0m in [0;35m_call_impl[0m
    return forward_call(*args, **kwargs)[0m
[0m  File [0;32m/data/zlt/RemoteSensePET/models/pet.py:697[0m in [0;35mforward[0m
    dense_input_embed = self.pos_embed(samples)  # B*hidden_dim*imgH*imgW[0m
[0m  File [0;32m~/ctf/anaconda3/envs/dinov2/lib/python3.9/site-packages/torch/nn/modules/module.py:1501[0m in [0;35m_call_impl[0m
    return forward_call(*args, **kwargs)[0m
[1;36m  File [1;32m/data/zlt/RemoteSensePET/models/position_encoding.py:49[1;36m in [1;35mforward[1;36m
[1;33m    pos = torch.cat((pos_y, pos_x), dim=3).permute(0, 3, 1, 2)[1;36m
[1;31mOutOfMemoryError[0m[1;31m:[0m CUDA out of memory. Tried to allocate 7.50 GiB (GPU 0; 23.68 GiB total capacity; 8.25 GiB already allocated; 6.93 GiB free; 16.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

Finished eval with robust_para=2.0
----------------------------------------
